(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{424:function(t,s,a){"use strict";a.r(s);var n=a(54),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),a("p",[a("code",[t._v("Version v2.16.1")])]),t._v(" "),a("p",[t._v("Helm: 客户端，管理本地的Chart仓库，于Tiller服务器交互，发送Chart，实例安装，查询，卸载等操作")]),t._v(" "),a("p",[t._v("Tiller: 服务端，接收helm发来的Charts与Config，合并生成release")]),t._v(" "),a("p",[t._v("Chart: helm程序包")]),t._v(" "),a("p",[t._v("Repository: Charts仓库，http/https服务器")]),t._v(" "),a("p",[t._v("Release: 特定Chart部署于目标集群上的一个实例")]),t._v(" "),a("p",[t._v("Chart -> Config -> Release")]),t._v(" "),a("h2",{attrs:{id:"部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署"}},[t._v("#")]),t._v(" 部署")]),t._v(" "),a("p",[a("code",[t._v("添加service account和clusterRoleBinding")])]),t._v(" "),a("p",[a("code",[t._v("helm-rbac.yaml")])]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ServiceAccount\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" tiller\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("namespace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kube"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("system\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("---")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" rbac.authorization.k8s.io/v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ClusterRoleBinding\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" tiller\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("roleRef")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiGroup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" rbac.authorization.k8s.io\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ClusterRole\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" cluster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("admin\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("subjects")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ServiceAccount\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" tiller\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("namespace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" kube"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("system\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("kubectl apply -f helm-rbac.yaml\n")])])]),a("p",[a("code",[t._v("安装helm")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://get.helm.sh/helm-v2.16.1-linux-amd64.tar.gz'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tar")]),t._v(" -zxv -f helm-v2.16.1-linux-amd64.tar.gz"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cp")]),t._v(" ./linux-amd64/helm /usr/local/bin\n")])])]),a("p",[a("code",[t._v("初始化helm; 部署tiller")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("helm init --service-account"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("tiller --tiller-image"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("sapcc/tiller:v2.16.1 --stable-repo-url"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://kubernetes.oss-cn-hangzhou.aliyuncs.com/charts --history-max "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),t._v("\n")])])]),a("p",[t._v("说明：")]),t._v(" "),a("p",[t._v("因为某些原因 需要将默认tiller-image, stable-repo源替换掉")]),t._v(" "),a("p",[a("code",[t._v("启动本地Repository Server")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm serve &")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm repo list")]),t._v("\nNAME  \tURL\nstable\thttp://mirror.azure.cn/kubernetes/charts/\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v(" \thttp://127.0.0.1:8879/charts\n")])])]),a("p",[a("code",[t._v("查看版本")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm version")]),t._v("\nClient: "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("version.Version"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SemVer:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"v2.16.1"')]),t._v(", GitCommit:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bbdfe5e7803a12bbdf97e94cd847859890cf4050"')]),t._v(", GitTreeState:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"clean"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nServer: "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v("version.Version"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("SemVer:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"v2.16.1"')]),t._v(", GitCommit:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"bbdfe5e7803a12bbdf97e94cd847859890cf4050"')]),t._v(", GitTreeState:"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"clean"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("code",[t._v("参考")])]),t._v(" "),a("p",[a("code",[t._v("https://devopscube.com/install-configure-helm-kubernetes/")])]),t._v(" "),a("h2",{attrs:{id:"实战"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实战"}},[t._v("#")]),t._v(" 实战")]),t._v(" "),a("h3",{attrs:{id:"项目myhttp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目myhttp"}},[t._v("#")]),t._v(" 项目myhttp")]),t._v(" "),a("p",[t._v("部署ingress方式的myhttp服务")]),t._v(" "),a("p",[a("code",[t._v("创建myhttp chart")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm create myhttp")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# tree myhttp")]),t._v("\nmyhttp\n├── charts\n├── Chart.yaml  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 该chart的描述文件")]),t._v("\n├── templates   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 目录下是YAML文件的模板，\b该模板文件遵循Go template语法")]),t._v("\n│   ├── deployment.yaml\n│   ├── _helpers.tpl  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 全局模版，给其它模版使用")]),t._v("\n│   ├── ingress.yaml\n│   ├── NOTES.txt\n│   ├── serviceaccount.yaml\n│   ├── service.yaml\n│   └── tests\n│       └── test-connection.yaml\n└── values.yaml "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 变量值文件，给templates里面的模版文件引用")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" directories, "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v(" files\n")])])]),a("p",[a("code",[t._v("修改配置文件内容")])]),t._v(" "),a("ol",[a("li",[a("code",[t._v("values.yaml")])])]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("replicaCount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("repository")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 172.188.3.24"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("8000/library/myhttp\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ingress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("enabled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("annotations")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# kubernetes.io/ingress.class: nginx")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('# kubernetes.io/tls-acme: "true"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hosts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" www.myhttp.com\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("paths")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 如果多个uri ['/', '/api']")]),t._v("\n")])])]),a("p",[a("code",[t._v("检查依赖和模板配置是否正确")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm lint myhttp")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Linting myhttp\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INFO"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Chart.yaml: icon is recommended\n\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" chart"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" linted, no failures\n")])])]),a("p",[a("code",[t._v("打包chart")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm package myhttp --debug")]),t._v("\nSuccessfully packaged chart and saved it to: /root/helm/myhttp-0.1.0.tgz\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Successfully saved /root/helm/myhttp-0.1.0.tgz to /root/.helm/repository/local\n\n")])])]),a("p",[a("code",[t._v("查看chart")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm search myhttp")]),t._v("\nNAME        \tCHART VERSION\tAPP VERSION\tDESCRIPTION\nlocal/myhttp\t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),t._v(".0        \t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("        \tA Helm chart "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" Kubernetes\n")])])]),a("p",[a("code",[t._v("在kubernetes部署chart")])]),t._v(" "),a("ol",[a("li",[a("code",[t._v("预部署")])])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm install --dry-run --debug local/myhttp --name myhttp-chart")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Created tunnel using "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v(" port: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'7474'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" SERVER: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"127.0.0.1:7474"')]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Original chart version: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Fetched local/myhttp to /root/.helm/cache/archive/myhttp-0.1.0.tgz\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" CHART "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("PATH")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" /root/.helm/cache/archive/myhttp-0.1.0.tgz\n\nNAME:   myhttp-chart\nREVISION: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\nRELEASED: Fri Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":02:14 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\nCHART: myhttp-0.1.0\n"),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),t._v("-SUPPLIED VALUES:\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nCOMPUTED VALUES:\naffinity: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nfullnameOverride: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\nimage:\n  pullPolicy: IfNotPresent\n  repository: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.188")]),t._v(".3.24:8000/library/myhttp\n  tag: v1\nimagePullSecrets: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ningress:\n  annotations: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  enabled: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n  hosts:\n  - host: www.myhttp.com\n    paths:\n    - /\n  tls: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nnameOverride: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\nnodeSelector: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\npodSecurityContext: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nreplicaCount: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\nresources: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nsecurityContext: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nservice:\n  port: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n  type: ClusterIP\nserviceAccount:\n  create: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n  name: null\ntolerations: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\nHOOKS:\n---\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# myhttp-chart-test-connection")]),t._v("\napiVersion: v1\nkind: Pod\nmetadata:\n  name: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myhttp-chart-test-connection"')]),t._v("\n  labels:\n    app.kubernetes.io/name: myhttp\n    helm.sh/chart: myhttp-0.1.0\n    app.kubernetes.io/instance: myhttp-chart\n    app.kubernetes.io/version: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')]),t._v("\n    app.kubernetes.io/managed-by: Tiller\n  annotations:\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"helm.sh/hook"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" test-success\nspec:\n  containers:\n    - name: "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v("\n      image: busybox\n      command: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'wget'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      args:  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'myhttp-chart:80'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  restartPolicy: Never\nMANIFEST:\n\n---\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Source: myhttp/templates/serviceaccount.yaml")]),t._v("\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: myhttp-chart\n  labels:\n    app.kubernetes.io/name: myhttp\n    helm.sh/chart: myhttp-0.1.0\n    app.kubernetes.io/instance: myhttp-chart\n    app.kubernetes.io/version: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')]),t._v("\n    app.kubernetes.io/managed-by: Tiller\n---\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Source: myhttp/templates/service.yaml")]),t._v("\napiVersion: v1\nkind: Service\nmetadata:\n  name: myhttp-chart\n  labels:\n    app.kubernetes.io/name: myhttp\n    helm.sh/chart: myhttp-0.1.0\n    app.kubernetes.io/instance: myhttp-chart\n    app.kubernetes.io/version: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')]),t._v("\n    app.kubernetes.io/managed-by: Tiller\nspec:\n  type: ClusterIP\n  ports:\n    - port: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n      targetPort: http\n      protocol: TCP\n      name: http\n  selector:\n    app.kubernetes.io/name: myhttp\n    app.kubernetes.io/instance: myhttp-chart\n---\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Source: myhttp/templates/deployment.yaml")]),t._v("\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: myhttp-chart\n  labels:\n    app.kubernetes.io/name: myhttp\n    helm.sh/chart: myhttp-0.1.0\n    app.kubernetes.io/instance: myhttp-chart\n    app.kubernetes.io/version: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')]),t._v("\n    app.kubernetes.io/managed-by: Tiller\nspec:\n  replicas: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: myhttp\n      app.kubernetes.io/instance: myhttp-chart\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: myhttp\n        app.kubernetes.io/instance: myhttp-chart\n    spec:\n      serviceAccountName: myhttp-chart\n      securityContext:\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n      containers:\n        - name: myhttp\n          securityContext:\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n          image: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"172.188.3.24:8000/library/myhttp:v1"')]),t._v("\n          imagePullPolicy: IfNotPresent\n          ports:\n            - name: http\n              containerPort: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n              protocol: TCP\n          livenessProbe:\n            httpGet:\n              path: /\n              port: http\n          readinessProbe:\n            httpGet:\n              path: /\n              port: http\n          resources:\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n---\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Source: myhttp/templates/ingress.yaml")]),t._v("\napiVersion: networking.k8s.io/v1beta1\nkind: Ingress\nmetadata:\n  name: myhttp-chart\n  labels:\n    app.kubernetes.io/name: myhttp\n    helm.sh/chart: myhttp-0.1.0\n    app.kubernetes.io/instance: myhttp-chart\n    app.kubernetes.io/version: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')]),t._v("\n    app.kubernetes.io/managed-by: Tiller\nspec:\n  rules:\n    - host: "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"www.myhttp.com"')]),t._v("\n      http:\n        paths:\n          - path: /\n            backend:\n              serviceName: myhttp-chart\n              servicePort: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[a("code",[t._v("部署")])])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm install local/myhttp --name myhttp-chart")]),t._v("\nNAME:   myhttp-chart\nLAST DEPLOYED: Fri Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":06:32 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\nNAMESPACE: default\nSTATUS: DEPLOYED\n\nRESOURCES:\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" v1/Deployment\nNAME          AGE\nmyhttp-chart  0s\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" v1/Pod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("related"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nNAME                           AGE\nmyhttp-chart-699c968dc7-747kj  0s\nmyhttp-chart-699c968dc7-sss9t  0s\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" v1/Service\nNAME          AGE\nmyhttp-chart  0s\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" v1/ServiceAccount\nNAME          AGE\nmyhttp-chart  0s\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" v1beta1/Ingress\nNAME          AGE\nmyhttp-chart  0s\n\n\nNOTES:\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(". Get the application URL by running these commands:\n  http://www.myhttp.com/\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[a("code",[t._v("测试、验证")])])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# kubectl get deployment -l 'app.kubernetes.io/instance=myhttp-chart,app.kubernetes.io/name=myhttp'")]),t._v("\nNAME           READY   UP-TO-DATE   AVAILABLE   AGE\nmyhttp-chart   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("/2     "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("            "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("           63m\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# kubectl get svc -l 'app.kubernetes.io/instance=myhttp-chart,app.kubernetes.io/name=myhttp'")]),t._v("\nNAME           TYPE        CLUSTER-IP     EXTERNAL-IP   PORT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("S"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   AGE\nmyhttp-chart   ClusterIP   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.106")]),t._v(".44.95   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/TCP    64m\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# kubectl get ingress")]),t._v("\nNAME           HOSTS                        ADDRESS          PORTS   AGE\nmyhttp-chart   www.myhttp.com               "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.108")]),t._v(".162.246   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("      64m\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("➜  ~ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -x "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'172.188.2.86:80'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://www.myhttp.com'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"status"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SUCCESS"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello from server"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"升级"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#升级"}},[t._v("#")]),t._v(" 升级")]),t._v(" "),a("p",[t._v("myhttp:v1 -> myhttp:v2")]),t._v(" "),a("p",[a("code",[t._v("修改配置文件")])]),t._v(" "),a("p",[a("code",[t._v("values.yaml")])]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("repository")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 172.188.3.24"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("8000/library/myhttp\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v2\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("pullPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" IfNotPresent\n")])])]),a("p",[a("code",[t._v("Chart.yaml")])]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 0.2.0\n")])])]),a("p",[a("code",[t._v("打包")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm package myhttp --debug")]),t._v("\nSuccessfully packaged chart and saved it to: /root/helm/myhttp-0.2.0.tgz\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("debug"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Successfully saved /root/helm/myhttp-0.2.0.tgz to /root/.helm/repository/local\n\n")])])]),a("p",[a("code",[t._v("查看版本")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm search myhttp -l")]),t._v("\nNAME        \tCHART VERSION\tAPP VERSION\tDESCRIPTION\nlocal/myhttp\t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.2")]),t._v(".0        \t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("        \tA Helm chart "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" Kubernetes\nlocal/myhttp\t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),t._v(".0        \t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("        \tA Helm chart "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" Kubernetes\n")])])]),a("p",[a("code",[t._v("升级, 如果没有指定版本默认升级到最新版本")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm upgrade myhttp-chart local/myhttp --version=0.2.0")]),t._v("\nRelease "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myhttp-chart"')]),t._v(" has been upgraded.\nLAST DEPLOYED: Fri Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":44:55 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\nNAMESPACE: default\nSTATUS: DEPLOYED\n\nRESOURCES:\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" v1/Deployment\nNAME          AGE\nmyhttp-chart  98m\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" v1/Pod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("related"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nNAME                           AGE\nmyhttp-chart-699c968dc7-747kj  98m\nmyhttp-chart-699c968dc7-sss9t  98m\nmyhttp-chart-cf9f495d8-jrh42   0s\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" v1/Service\nNAME          AGE\nmyhttp-chart  98m\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" v1/ServiceAccount\nNAME          AGE\nmyhttp-chart  98m\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" v1beta1/Ingress\nNAME          AGE\nmyhttp-chart  98m\n\n\nNOTES:\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(". Get the application URL by running these commands:\n  http://www.myhttp.com/\n")])])]),a("p",[a("code",[t._v("验证、测试")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm list")]),t._v("\nNAME        \tREVISION\tUPDATED                 \tSTATUS  \tCHART        \tAPP VERSION\tNAMESPACE\nmyhttp-chart\t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("       \tFri Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":44:55 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\tDEPLOYED\tmyhttp-0.2.0 \t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("        \tdefault\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("➜  ~ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -x "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'172.188.2.86:80'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://www.myhttp.com'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"status"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SUCCESS"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"version"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"v2"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hostname"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myhttp-chart-cf9f495d8-8vcdj"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"IP"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10.244.1.11"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"回退"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#回退"}},[t._v("#")]),t._v(" 回退")]),t._v(" "),a("p",[a("code",[t._v("查看Release变更记录")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm history myhttp-chart")]),t._v("\nREVISION\tUPDATED                 \tSTATUS    \tCHART       \tAPP VERSION\tDESCRIPTION\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("       \tFri Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":06:32 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\tSUPERSEDED\tmyhttp-0.1.0\t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("        \tInstall complete\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("       \tFri Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":44:55 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\tDEPLOYED  \tmyhttp-0.2.0\t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("        \tUpgrade complete\n")])])]),a("p",[a("code",[t._v("回退")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm rollback myhttp-chart 1")]),t._v("\nRollback was a success.\n")])])]),a("p",[a("code",[t._v("验证、测试")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm list")]),t._v("\nNAME        \tREVISION\tUPDATED                 \tSTATUS  \tCHART        \tAPP VERSION\tNAMESPACE\nmyhttp-chart\t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("       \tFri Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":53:25 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\tDEPLOYED\tmyhttp-0.1.0 \t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("        \tdefault\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm history myhttp-chart")]),t._v("\nREVISION\tUPDATED                 \tSTATUS    \tCHART       \tAPP VERSION\tDESCRIPTION\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("       \tFri Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":06:32 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\tSUPERSEDED\tmyhttp-0.1.0\t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("        \tInstall complete\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("       \tFri Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":44:55 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\tSUPERSEDED\tmyhttp-0.2.0\t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("        \tUpgrade complete\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("       \tFri Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":53:25 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\tDEPLOYED  \tmyhttp-0.1.0\t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("        \tRollback to "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n")])])]),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("➜  ~ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -x "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'172.188.2.86:80'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://www.myhttp.com'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"status"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SUCCESS"')]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello from server"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除"}},[t._v("#")]),t._v(" 删除")]),t._v(" "),a("p",[a("code",[t._v("删除")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm delete myhttp-chart")]),t._v("\nrelease "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myhttp-chart"')]),t._v(" deleted\n")])])]),a("p",[a("code",[t._v("验证")])]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm list -a")]),t._v("\nNAME        \tREVISION\tUPDATED                 \tSTATUS  \tCHART        \tAPP VERSION\tNAMESPACE\nmyhttp-chart\t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("       \tFri Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":53:25 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\tDELETED \tmyhttp-0.1.0 \t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("        \tdefault\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@master helm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# helm history myhttp-chart")]),t._v("\nREVISION\tUPDATED                 \tSTATUS    \tCHART       \tAPP VERSION\tDESCRIPTION\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("       \tFri Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(":06:32 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\tSUPERSEDED\tmyhttp-0.1.0\t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("        \tInstall complete\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("       \tFri Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":44:55 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\tSUPERSEDED\tmyhttp-0.2.0\t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("        \tUpgrade complete\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("       \tFri Feb "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("16")]),t._v(":53:25 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v("\tDELETED   \tmyhttp-0.1.0\t"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v("        \tDeletion complete\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);