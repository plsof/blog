(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{468:function(s,a,t){"use strict";t.r(a);var e=t(54),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"分隔符"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#分隔符"}},[s._v("#")]),s._v(" 分隔符")]),s._v(" "),t("h3",{attrs:{id:"fs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#fs"}},[s._v("#")]),s._v(" FS")]),s._v(" "),t("p",[s._v("The input field separator, a space by default 字段分隔符")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# awk 'BEGIN{FS=\":\"}{print $1,$2,$3,$4,$5}' /etc/passwd")]),s._v("\nmail x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" mail\nuucp x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" uucp\noperator x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" operator\ngames x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" games\ngopher x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" gopher\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ftp")]),s._v(" x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50")]),s._v(" FTP User\n")])])]),t("h4",{attrs:{id:"指定多个fs-空格-多个空格"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#指定多个fs-空格-多个空格"}},[s._v("#")]),s._v(" 指定多个FS(空格，多个空格，：，#，？)")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# awk -F '[ ]+|[:#?]' '{print $1,$2,$3,$4,$5,$6,$7}' /etc/passwd")]),s._v("\nmail x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" mail /var/spool/mail /sbin/nologin\nuucp x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" uucp /var/spool/uucp /sbin/nologin\noperatorx "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" operator /root /sbin/nologin\ngames x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" games /usr/games /sbin/nologin\ngopher x "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" gopher /var/gopher /sbin/nologin\n")])])]),t("h3",{attrs:{id:"ofs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ofs"}},[s._v("#")]),s._v(" OFS")]),s._v(" "),t("p",[s._v("The output field separator, a space by default 输出字段分隔符")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# awk \'BEGIN{FS=":";OFS="#"}{print $1,$2,$3,$4,$5}\' /etc/passwd')]),s._v("\nmail"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#x#8#12#mail")]),s._v("\nuucp"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#x#10#14#uucp")]),s._v("\noperator"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#x#11#0#operator")]),s._v("\ngames"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#x#12#100#games")]),s._v("\ngopher"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#x#13#30#gopher")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ftp")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#x#14#50#FTP User")]),s._v("\n")])])]),t("h3",{attrs:{id:"rs"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rs"}},[s._v("#")]),s._v(" RS")]),s._v(" "),t("p",[s._v("The input record separator, by default a newline 记录分隔符")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# awk 'BEGIN{RS=\":\"}{print $0}' /etc/passwd")]),s._v("\nmail\nx\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v("\nmail\n/var/spool/mail\n/sbin/nologin\nuucp\nx\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v("\nuucp\n/var/spool/uucp\n/sbin/nologin\noperator\nx\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\noperator\n/root\n/sbin/nologin\ngames\n")])])]),t("h3",{attrs:{id:"ors"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ors"}},[s._v("#")]),s._v(" ORS")]),s._v(" "),t("p",[s._v("The output record separator, by default a newline 输出记录分隔符")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# awk \'BEGIN{FS=":";ORS="#"}{print $0}\' /etc/passwd')]),s._v("\nmail:x:8:12:mail:/var/spool/mail:/sbin/nologin"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin#operator:x:11:0:operator:/root:/sbin/nologin#games:x:12:100:games:/usr/games:/sbin/nologin#gopher:x:13:30:gopher:/var/gopher:/sbin/nologin#ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin#")]),s._v("\n")])])]),t("h2",{attrs:{id:"数组"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数组"}},[s._v("#")]),s._v(" 数组")]),s._v(" "),t("h4",{attrs:{id:"示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[s._v("#")]),s._v(" 示例")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80.80")]),s._v(".80.67 - - "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-10-29T00:01:01+08:00"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GET /ysten-lvoms-epg/epg/getChannelNextProgram.shtml?uuid=cctv-14&curprogramId=175430298&programName=%E5%8A%A8%E7%94%BB%E5%A4%A7%E6%94%BE%E6%98%A0:%E5%96%80%E6%96%AF%E7%89%B9%E7%A5%9E%E5%A5%87%E4%B9%8B%E6%97%85&startTime=1572220920&action=next&templateId=02850&deviceGroupId=556&districtCode=510600&random=0.23766797524876893 HTTP/1.1"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("149")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://jtdsepg.cdzgys.cn/watchTV2.0/watchTV11.0/index.html?businessType=livereplay&mediaType=live&fromwhere=playback&templateId=02850&catgId=ysten-cctv-1&userId=25539939"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gefo5(ysten)"')]),s._v(" - "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.000"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"looktvepg.sc.ysten.com"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7070"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"HIT"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80.80")]),s._v(".80.40 - - "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),s._v("-10-29T00:01:01+08:00"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GET /ysten-lvoms-epg/epg/getChannelNextProgram.shtml?uuid=cctv-6&curprogramId=175106624&programName=%E7%AC%91%E5%82%B2%E6%B1%9F%E6%B9%96&startTime=1572185700&action=next&templateId=0286&deviceGroupId=821&districtCode=510100&random=0.8053548543248326 HTTP/1.1"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"200"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("135")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://jtdsepg.cdzgys.cn/watchTV2.0/watchTV11.0/index.html?businessType=livereplay&mediaType=live&fromwhere=playback&templateId=0286&catgId=ysten-cctv-1&userId=25690871"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gefo5(ysten)"')]),s._v(" - "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.000"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"looktvepg.sc.ysten.com"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7070"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"HIT"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v("\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# awk -F \"[ ]+|?\" '{a[$12]++;n++}END{for(i in a)print i,a[i],a[i]/n}' looktvepg.access.log20191029 | sort -n -r -k2")]),s._v("\n")])])]),t("h2",{attrs:{id:"条件判断"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#条件判断"}},[s._v("#")]),s._v(" 条件判断")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'$4>="[2019-10-28T01:00:00+08:00]" && $4<"[2019-10-28T03:00:00+08:00]" {print}\'')]),s._v(" looktvepg.access.log20191029\n")])])]),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2017/07/05 @pdd")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# egrep "015164026490197|015164026498133|015164026498581|015164026496744|015164026495932|015373001004176" /nginxlogs/tms.access.log')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LOG")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/nginxlogs/tms.access.log"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MIN")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# minutes must great than 30")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v('"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v('"')]),s._v(" -gt "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PRETIME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v(' min"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"+%Y-%m-%dT%T"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PRETIME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-30 min"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"+%Y-%m-%dT%T"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("fi")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TIME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"["')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PRETIME}")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"+08:00]"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 时间 HTTP状态码 串号 节点")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -v "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("actime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$TIME")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$4 >= actime {print $4,$8,substr($12,2,15),$15}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$LOG")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{if($3==015164026498581) print "A在线",$0; else if($3==015164026490197) print "B在线"; else if($3==015373001004176) print "C在线",$0}\'')]),s._v("\n")])])]),t("h2",{attrs:{id:"变量传值"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#变量传值"}},[s._v("#")]),s._v(" 变量传值")]),s._v(" "),t("h4",{attrs:{id:"每分钟的请求占比"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#每分钟的请求占比"}},[s._v("#")]),s._v(" 每分钟的请求占比")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("i")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ptime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$((")]),s._v("$i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("))")])]),s._v(' minute 20191001 0950"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"+[%Y-%m-%dT%H:%M:%S+08:00]"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ntime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$((")]),s._v("$i"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("))")])]),s._v(' minute 20191001 0950"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"+[%Y-%m-%dT%H:%M:%S+08:00]"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ptime")]),s._v(" - "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ntime")]),s._v('"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -v "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ptime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ptime")]),s._v(" -v "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ntime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ntime")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'$4 >=ptime && $4<ntime {a[$NF]++;n++} END{for(i in a)print i,a[i]/n*100"%";print "一分钟总行数"n}\'')]),s._v(" looktvepg.access.log20191001\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])])]),t("h4",{attrs:{id:"每十秒的访问量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#每十秒的访问量"}},[s._v("#")]),s._v(" 每十秒的访问量")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token for-or-select variable"}},[s._v("i")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ptime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$((")]),s._v("$i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("))")])]),s._v(' seconds 20191106 01:03"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"+[%Y-%m-%dT%H:%M:%S+08:00]"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ntime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" -d "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$((")]),s._v("$i"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("))")])]),s._v(' seconds 20191106 01:03"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"+[%Y-%m-%dT%H:%M:%S+08:00]"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ptime")]),s._v(" - "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ntime")]),s._v('"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" getChannelNextProgram looktvepg.access.log "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" ysten-cctv-5 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -v "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ptime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ptime")]),s._v(" -v "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ntime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ntime")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'$4 >=ptime && $4<=ntime {n++} END{print \"cctv5出现次数 \", n}'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\n")])])]),t("h2",{attrs:{id:"类型转换"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#类型转换"}},[s._v("#")]),s._v(" 类型转换")]),s._v(" "),t("h3",{attrs:{id:"字符串-整数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#字符串-整数"}},[s._v("#")]),s._v(" 字符串 -> 整数")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "" | awk \'{a="asd";a+0;print a}\'')]),s._v("\nasd\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "" | awk \'{a="asd123";a+0;print a}\'')]),s._v("\nasd123\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "" | awk \'{a="\\"123\\"";a+0;print a}\'')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"123"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "" | awk \'{a="123";a+0;print a}\'')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v("\n")])])]),t("h3",{attrs:{id:"整数-字符串"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#整数-字符串"}},[s._v("#")]),s._v(" 整数 -> 字符串")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# echo "" | awk \'BEGIN{a=100;b=100;c=(a""b);print c}\'')]),s._v("\n")])])]),t("h2",{attrs:{id:"内置函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#内置函数"}},[s._v("#")]),s._v(" 内置函数")]),s._v(" "),t("h3",{attrs:{id:"split"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#split"}},[s._v("#")]),s._v(" split")]),s._v(" "),t("p",[t("code",[s._v("日志")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80.80")]),s._v(".80.112 - - "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2020")]),s._v("-03-06T00:01:02+08:00"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"GET /local/common/tp8/watchTV_U/images/player/key/btn_11.png HTTP/1.1"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"304"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://jtdsepg.cdzgys.cn/local/common/tp8/watchTV_U/index.html?templateId=02867&catgId=ysten-cctv-1&businessType=livereplay&mediaType=live&fromwhere=playback&userId=143643005&source=4&fromChannel=panel&platformId=2"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"gefo8(ysten) va2d"')]),s._v(" - "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0.000"')]),s._v("  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jtdsepg.cdzgys.cn"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"80"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-"')]),s._v("\n")])])]),t("p",[t("code",[s._v("统计request_time > 9s的占比")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{split($(NF-4),a,"\\"");if(a[2]>9) i++}END{print i,i/NR}\'')]),s._v("\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);